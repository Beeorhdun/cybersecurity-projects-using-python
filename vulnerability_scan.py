import nmap

# Define the target IP address or hostname
target = '127.0.0.1'

# Create an instance of the PortScanner class
scanner = nmap.PortScanner()

# Perform a basic vulnerability scan on the target
scanner.scan(hosts=target, arguments='-p 1-65535 -sV --script vuln')

# Print scan results
for host in scanner.all_hosts():
    print('----------------------------------------------------')
    print(f'Host : {host} ({scanner[host].hostname()})')
    print('State :', scanner[host].state())
    for proto in scanner[host].all_protocols():
        print('----------')
        print(f'Protocol : {proto}')
        ports = scanner[host][proto].keys()
        for port in ports:
            print(f'Port : {port}\tState : {scanner[host][proto][port]["state"]}')
            if 'script' in scanner[host][proto][port]:
                print('Vulnerability Scripts:')
                for script in scanner[host][proto][port]['script']:
                    print(f'\t{script} : {scanner[host][proto][port]["script"][script]}')


#This script utilizes the nmap library to perform a vulnerability scan on a target host specified by the target variable.
#It scans all ports (1-65535) and attempts to detect service versions (-sV) while also running vulnerability scripts (--script vuln).